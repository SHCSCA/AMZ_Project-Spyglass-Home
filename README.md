# 产品需求文档 (PRD): 亚马逊竞品情报系统 V2.0 - 前端界面 (UI)

| 文档版本 | V2.0 (UI) |
| :--- | :--- |
| **项目名称** | 亚马逊竞品情报系统 (Project Spyglass) - 前端 |
| **创建日期** | 2025年11月01日 |
| **修订说明** | **V2.0: ** 基于后端 V2.0 PRD 制定。定义了消费 API 所需的核心用户界面，包括仪表盘、详情页图表和 V2.0 新增的告警/差评模块。 |
| **目标** | 提供一个快速、响应式、数据驱动的Web界面，将后端API数据转化为运营者可操作的视觉情报。 |

---

## 1. 简介

### 1.1. 目标
本项目的前端 (UI) 旨在消费 `spyglass-backend` V2.0 提供的 RESTful API，实现PRD中定义的所有P0和P1级用户故事。

**核心用户旅程：**
1.  **登录即知：** 用户打开界面，首先看到“全局告警中心”，立刻知道哪些产品发生了什么事。
2.  **概览大盘：** 用户切换到“ASIN仪表盘”，查看所有监控ASIN的最新状态。
3.  **深度分析：** 用户点击单个ASIN，进入“详情页”，查看历史图表和具体的差评内容。
4.  **管理监控：** 用户在仪表盘上添加或删除ASIN。

### 1.2. 技术栈与API
* **技术栈 (推荐):** React (Vite) 或 Vue 3。
* **图表库 (推荐):** Chart.js 或 ECharts。
* **UI 库 (推荐):** Ant Design, Material-UI, 或 Chakra UI (确保有强大的表格和模态框组件)。
* **API 来源:** 严格遵循后端提供的 OpenAPI 规范 (`/v3/api-docs`)。

---

## 2. 功能模块 (Functional Modules & Views)

### F-MOD-1: 全局布局 (Global Layout)
* **F-UI-101 (导航):** 必须提供一个持久化的侧边栏或顶部导航栏，允许用户在以下三个主要视图之间切换：
    1.  **全局告警 (Global Alerts)** (默认页)
    2.  **ASIN 仪表盘 (Dashboard)**
    3.  *(V3.0 预留) 设置 (Settings)*
* **F-UI-102 (加载状态):** 在任何API请求期间（例如加载表格、图表数据），必须显示清晰的加载指示器（Loading Spinner/Skeleton）。
* **F-UI-103 (错误处理):** 当API调用失败时（例如500或404），必须在界面上显示用户友好的错误提示（例如 "数据加载失败"）。

### F-MOD-2: 视图 1 - 全局告警中心 (Global Alert Feed)
* **F-UI-201 (目标):** 满足 "登录即知" 的需求。作为应用的默认首页。
* **F-UI-202 (数据源):** `GET /api/alerts?limit=50&status=NEW`。
* **F-UI-203 (布局):**
    * 显示一个“告警列表”（List或Feed）。
    * **列表项 (Alert Card):** 每一项必须清晰地显示：
        * ASIN (及 昵称)
        * 告警类型 (例如: `PRICE_CHANGE`, `NEGATIVE_REVIEW`, `INVENTORY_LOW`)
        * 告警时间 (例如: "2小时前")
        * **告警详情 (P0):**
            * **价格:** "价格从 $19.99 变为 $17.99"
            * **库存:** "库存 (5) 低于阈值 (10)"
            * **标题/五点:** "标题发生变更"
            * **差评 (V2.0):** "收到新差评 (2星): [差评内容截断...]"
    * **F-UI-204 (交互):** 点击任一告警卡片，应导航到该ASIN的“详情页” (F-MOD-4)。
    * **F-UI-205 (操作):** (V2.1) 提供“标记为已读”或“全部清除”按钮。

### F-MOD-3: 视图 2 - ASIN 仪表盘 (Dashboard)
* **F-UI-301 (目标):** 概览所有监控的ASIN，并提供管理入口。
* **F-UI-302 (数据源):** `GET /api/asin`。
* **F-UI-303 (布局 - 表格):**
    * 必须使用“表格” (Table) 布局展示ASIN列表。
    * **表格列 (Columns):**
        * 昵称 (Nickname) / ASIN (点击可进入详情页 F-MOD-4)
        * 站点 (Site)
        * 最新价格 (Last Price)
        * 最新BSR (Last BSR)
        * **最新库存 (V2.0)** (Last Inventory)
        * 最新评论数 (Total Reviews)
        * 最新评分 (Avg Rating)
        * 库存阈值 (Threshold)
        * 操作 (Actions)
* **F-UI-304 (交互 - 添加ASIN):**
    * 页面必须有一个“添加ASIN”按钮。
    * 点击按钮弹出一个“模态框” (Modal)。
    * 模态框表单包含 `asin`, `site`, `nickname`, `inventoryThreshold` 字段。
    * 表单提交时调用 `POST /api/asin`。成功后自动关闭模态框并刷新表格。
* **F-UI-305 (交互 - 操作):**
    * “操作”列中，每一行必须有“编辑”和“删除”按钮。
    * **编辑:** 点击弹出模态框，预填充该ASIN数据，调用 `PUT /api/asin/{id}/config` 保存。
    * **删除:** 点击弹出确认框，确认后调用 `DELETE /api/asin/{id}`，成功后刷新表格。
* **F-UI-306 (告警标识):** (V2.1 优化) 仪表盘应能调用 `GET /api/alerts` 并聚合，在ASIN行上显示一个“红点”或标识，表明该ASIN有新告警。

### F-MOD-4: 视图 3 - ASIN 详情页 (ASIN Detail Page)
* **F-UI-401 (目标):** 深度分析单个ASIN的历史趋势和具体变更内容。
* **F-UI-402 (布局):**
    * **顶部:** 显示ASIN的昵称、ASIN码、当前价格、BSR等关键信息。
    * **中部 (图表区):**
        * **数据源:** `GET /api/asin/{id}/history?range=30d`。
        * 必须提供时间范围切换器 (例如: 7天, 30天, 90天)，切换时重新调用API。
        * **图表 1 (P0):** 价格 (Price) 历史折线图。
        * **图表 2 (P0):** BSR (BSR) 历史折线图。
        * **图表 3 (P1):** 库存 (Inventory) 历史折线图 (V2.0 需求)。
    * **底部 (V2.0 Tab页):**
        * **Tab 1: 告警记录 (Alerts)**
            * **数据源:** `GET /api/asin/{id}/alerts`。
            * 显示此ASIN的所有历史告警列表 (同 F-UI-203 布局)。
        * **Tab 2: 差评列表 (Negative Reviews)**
            * **数据源:** `GET /api/asin/{id}/reviews?rating=negative`。
            * **布局:** 显示一个差评列表 (1-3星)。
            * **列表项:** 必须显示 评分、评论日期、**评论全文 (Review Text)**。
        * **Tab 3: (V2.1) 内容变更对比 (Diff)**
            * 当告警类型为 标题/五点/A+ 变更时，在此处调用API获取新旧值，并高亮显示差异 (Diff)。

---

## 3. 非功能性需求 (NFRs)

| 类别 | 需求 (NFR) |
| :--- | :--- |
| **性能** | **NFR-UI-P001:** 仪表盘页面 (UI) 首次加载时间必须在 **3 秒** 以下。 |
| | **NFR-UI-P002:** 页面内导航切换（例如 告警 -> 仪表盘）必须感觉即时（< 500ms）。 |
| | **NFR-UI-P003:** 详情页图表必须在 1.5 秒内渲染完成（API响应后）。 |
| **兼容性**| **NFR-UI-C001:** 必须在最新版的 Chrome 和 Firefox 浏览器上完美运行。 |
| **响应式**| **NFR-UI-R001:** 界面必须是响应式的，在桌面（主要）和移动设备（次要，可读）上均可正常访问。 |
| **API** | **NFR-UI-A001:** **禁止**在前端硬编码任何API URL。所有API端点必须可通过环境变量 (`VITE_API_BASE_URL`) 配置，以指向后端服务。 |

---

## 4. API 关键依赖 (V2.0)

前端开发**必须**依赖以下V2.0 API端点：

| HTTP | 路径 | 描述 | 视图依赖 |
| :--- | :--- | :--- | :--- |
| `GET` | `/api/asin` | 获取所有ASIN列表 | **仪表盘** (P0) |
| `POST`| `/api/asin` | 添加新ASIN | **仪表盘** (P0) |
| `PUT` | `/api/asin/{id}/config`| 更新ASIN配置 | **仪表盘** (P0) |
| `DELETE`| `/api/asin/{id}` | 删除ASIN | **仪表盘** (P0) |
| `GET` | `/api/asin/{id}/history` | 获取ASIN历史数据 | **详情页-图表** (P0) |
| `GET` | `/api/alerts` | (V2.0) 获取全局告警 | **全局告警中心** (P0) |
| `GET` | `/api/asin/{id}/alerts` | (V2.0) 获取ASIN特定告警 | **详情页-Tab1** (P1) |
| `GET` | `/api/asin/{id}/reviews`| (V2.0) 获取ASIN差评 | **详情页-Tab2** (P1) |
