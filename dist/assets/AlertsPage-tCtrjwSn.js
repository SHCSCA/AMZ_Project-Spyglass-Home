import{g as K,F as Z,m as ee,u as _,r as oe,a as s,C as M,c as I,b as V,d as re,o as te,i as le,e as ae,f as se,h as ne,j as c}from"./index-D2VK7OI4.js";import{W as ce,u as ie,L as de,E as ue,m as ge,S as pe,a as Ce,B as be,b as me}from"./mappers-rBk6T_aE.js";import{L as A,C as fe}from"./index-ypEmevj9.js";import{u as he,p as H}from"./useClosable-D4eDUDRQ.js";const ve=e=>{const{paddingXXS:r,lineWidth:l,tagPaddingHorizontal:o,componentCls:t,calc:i}=e,n=i(o).sub(l).equal(),b=i(r).sub(l).equal();return{[t]:Object.assign(Object.assign({},oe(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:n,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${_(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${t}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${t}-close-icon`]:{marginInlineStart:b,fontSize:e.tagIconSize,color:e.colorIcon,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${t}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${t}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:n}}),[`${t}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}},N=e=>{const{lineWidth:r,fontSizeIcon:l,calc:o}=e,t=e.fontSizeSM;return ee(e,{tagFontSize:t,tagLineHeight:_(o(e.lineHeightSM).mul(t).equal()),tagIconSize:o(l).sub(o(r).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.defaultBg})},P=e=>({defaultBg:new Z(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText}),W=K("Tag",e=>{const r=N(e);return ve(r)},P);var ye=function(e,r){var l={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&r.indexOf(o)<0&&(l[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,o=Object.getOwnPropertySymbols(e);t<o.length;t++)r.indexOf(o[t])<0&&Object.prototype.propertyIsEnumerable.call(e,o[t])&&(l[o[t]]=e[o[t]]);return l};const Se=s.forwardRef((e,r)=>{const{prefixCls:l,style:o,className:t,checked:i,children:n,icon:b,onChange:d,onClick:g}=e,v=ye(e,["prefixCls","style","className","checked","children","icon","onChange","onClick"]),{getPrefixCls:a,tag:p}=s.useContext(M),$=S=>{d==null||d(!i),g==null||g(S)},f=a("tag",l),[C,j,y]=W(f),T=I(f,`${f}-checkable`,{[`${f}-checkable-checked`]:i},p==null?void 0:p.className,t,j,y);return C(s.createElement("span",Object.assign({},v,{ref:r,style:Object.assign(Object.assign({},o),p==null?void 0:p.style),className:T,onClick:$}),b,s.createElement("span",null,n)))}),xe=e=>re(e,(r,{textColor:l,lightBorderColor:o,lightColor:t,darkColor:i})=>({[`${e.componentCls}${e.componentCls}-${r}`]:{color:l,background:t,borderColor:o,"&-inverse":{color:e.colorTextLightSolid,background:i,borderColor:i},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}})),$e=V(["Tag","preset"],e=>{const r=N(e);return xe(r)},P);function je(e){return typeof e!="string"?e:e.charAt(0).toUpperCase()+e.slice(1)}const x=(e,r,l)=>{const o=je(l);return{[`${e.componentCls}${e.componentCls}-${r}`]:{color:e[`color${l}`],background:e[`color${o}Bg`],borderColor:e[`color${o}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}},Te=V(["Tag","status"],e=>{const r=N(e);return[x(r,"success","Success"),x(r,"processing","Info"),x(r,"error","Error"),x(r,"warning","Warning")]},P);var Ee=function(e,r){var l={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&r.indexOf(o)<0&&(l[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,o=Object.getOwnPropertySymbols(e);t<o.length;t++)r.indexOf(o[t])<0&&Object.prototype.propertyIsEnumerable.call(e,o[t])&&(l[o[t]]=e[o[t]]);return l};const Oe=s.forwardRef((e,r)=>{const{prefixCls:l,className:o,rootClassName:t,style:i,children:n,icon:b,color:d,onClose:g,bordered:v=!0,visible:a}=e,p=Ee(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:$,direction:f,tag:C}=s.useContext(M),[j,y]=s.useState(!0),T=te(p,["closeIcon","closable"]);s.useEffect(()=>{a!==void 0&&y(a)},[a]);const S=le(d),w=ae(d),E=S||w,q=Object.assign(Object.assign({backgroundColor:d&&!E?d:void 0},C==null?void 0:C.style),i),u=$("tag",l),[k,D,U]=W(u),G=I(u,C==null?void 0:C.className,{[`${u}-${d}`]:E,[`${u}-has-color`]:d&&!E,[`${u}-hidden`]:!j,[`${u}-rtl`]:f==="rtl",[`${u}-borderless`]:!v},o,t,D,U),z=h=>{h.stopPropagation(),g==null||g(h),!h.defaultPrevented&&y(!1)},[,X]=he(H(e),H(C),{closable:!1,closeIconRender:h=>{const J=s.createElement("span",{className:`${u}-close-icon`,onClick:z},h);return se(h,J,m=>({onClick:R=>{var O;(O=m==null?void 0:m.onClick)===null||O===void 0||O.call(m,R),z(R)},className:I(m==null?void 0:m.className,`${u}-close-icon`)}))}}),Q=typeof p.onClick=="function"||n&&n.type==="a",B=b||null,Y=B?s.createElement(s.Fragment,null,B,n&&s.createElement("span",null,n)):n,L=s.createElement("span",Object.assign({},T,{ref:r,className:G,style:q}),Y,X,S&&s.createElement($e,{key:"preset",prefixCls:u}),w&&s.createElement(Te,{key:"status",prefixCls:u}));return k(Q?s.createElement(ce,{component:"Tag"},L):L)}),F=Oe;F.CheckableTag=Se;async function Ie(e,r,l){const o=new URLSearchParams({page:String(e),size:String(r)});return l&&o.set("type",l),me(`/api/alerts?${o.toString()}`)}const Be=()=>{const e=ne(),[r,l]=s.useState(1),[o,t]=s.useState(void 0),i=20,{data:n,loading:b,error:d,reload:g}=ie(()=>Ie(r-1,i,o),[r,o]);if(b)return c.jsx(de,{});if(d)return c.jsx(ue,{error:d});const v=((n==null?void 0:n.items)||[]).map(ge);return c.jsxs("div",{children:[c.jsxs(pe,{style:{marginBottom:12},children:[c.jsx(Ce,{allowClear:!0,placeholder:"告警类型",style:{width:180},value:o,onChange:a=>{l(1),t(a)},options:[{value:"PRICE_CHANGE",label:"价格变动"},{value:"INVENTORY_THRESHOLD",label:"库存阈值"},{value:"TITLE",label:"标题变更"},{value:"MAIN_IMAGE",label:"主图变更"},{value:"BULLET_POINTS",label:"五点要点变更"},{value:"APLUS_CONTENT",label:"A+内容变更"},{value:"NEGATIVE_REVIEW",label:"新差评"}]}),c.jsx(be,{onClick:()=>g(),children:"刷新"})]}),c.jsx(A,{pagination:{current:r,total:(n==null?void 0:n.total)||0,pageSize:i,onChange:a=>l(a)},dataSource:v,renderItem:a=>c.jsx(A.Item,{children:c.jsxs(fe,{size:"small",hoverable:!0,onClick:()=>e(`/asin/${a.asinId}`),children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[c.jsxs("div",{children:[c.jsx("strong",{children:a.asin})," · ",a.type," ",a.severity&&c.jsx(F,{color:a.severity==="ERROR"?"red":a.severity==="WARN"?"orange":"blue",children:a.severity})]}),c.jsx("small",{children:new Date(a.createdAt).toLocaleString()})]}),c.jsx("div",{style:{marginTop:8},children:a.message})]})})})]})};export{Be as default};
